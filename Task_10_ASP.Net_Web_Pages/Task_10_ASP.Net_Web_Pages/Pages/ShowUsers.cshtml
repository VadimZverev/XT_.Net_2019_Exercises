@using Task_10_ASP.Net_Web_Pages.Models;
@{
    Layout = "_Layout.cshtml";
    Page.Title = "Show Users";
    string msg = null;

    if (Request.QueryString["ErrorMsg"] != null)
    {
        msg = Request.QueryString["ErrorMsg"];
    }
}

<h3 class="p-2 bg-primary text-white text-center">Users</h3>

@if (msg != null)
{
    <div class="alert-danger">
        @msg
    </div>
}

<div>
    <table class="table table-striped table-bordered table-sm text-center">
        <thead>
            <tr>
                <td>Id</td>
                <td>Name</td>
                <td>Date of Birth</td>
                <td>Age</td>
                <td>Awards</td>
                <td class="text-center">Actions</td>
            </tr>
        </thead>
        <tbody>
            @foreach (var user in ProgramModel.GetUsers())
            {
                <tr>
                    <td>@user.Id</td>
                    <td>@user.Name</td>
                    <td>@user.DateOfBirth.ToShortDateString()</td>
                    <td>@user.Age</td>
                    <td>
                        @if (user.Awards.Any())
                        {
                            foreach (var award in user.Awards)
                            {
                                <div> - @award.Title</div>
                            }
                        }
                        else
                        {
                            <div>No Awards</div>
                        }
                    </td>
                    <td class="text-center">
                        <div class="custom-control-inline">
                            <form action="" method="post">
                                <input type="hidden" name="idUser" value="@user.Id" />
                                <input type="hidden" name="Mode" value="Update" />
                                <button type="submit" class="btn btn-warning btn-sm">
                                    Edit
                                </button>
                            </form>
                            <form action="" id="delUser@(user.Id)" method="post">
                                <input type="hidden" name="idUser" value="@user.Id" />
                                <input type="hidden" name="Mode" value="Delete" />
                                <input type="button" class="btn btn-danger btn-sm delete" value="delete" />
                            </form>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
<div>
    <a class="btn btn-primary" href="~/Pages/AddUser">Create</a>
    <a class="btn btn-secondary" href="~/Pages/">Cancel</a>
</div>

@RenderPage("/Pages/_ConfirmDeletePartial.cshtml")